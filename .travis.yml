language: d
d:
  - dmd-2.066.1
  - dmd-2.067.1
  - dmd-2.068.0
  - ldc-0.15.1
  - ldc-0.15.2-beta2
  - gdc-4.9.2
os:
  - linux
  - osx
sudo: false

addons:
  apt:
    packages:
      - libfreeimage-dev
      - libjpeg62-dev
      - libevent-dev
      - libssl-dev

matrix:
  allow_failures:
    - d: ldc-0.15.1
    - d: ldc-0.15.2-beta2
    - d: gdc-4.9.2

install:
  # Add ./lib/$TRAVIS_OS_NAME to the lib path
  - export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:`pwd`/lib/$TRAVIS_OS_NAME
  - export DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH:`pwd`/lib/$TRAVIS_OS_NAME
  - bash .travis/setup_osx
script:
  - dub fetch x11 --version="~>1.0"
  - dub upgrade
  - dub test --compiler=${DC}

notifications:
  webhooks:
    urls:
    - https://webhooks.gitter.im/e/89d5205a2483bcd72a32
    on_success: change
    on_failure: always
    on_start: never
